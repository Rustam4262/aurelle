# üöÄ –ë—ã—Å—Ç—Ä—ã–π –¥–µ–ø–ª–æ–π –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –Ω–∞ aurelle.uz

## ‚ö° –î–ª—è –Ω–µ—Ç–µ—Ä–ø–µ–ª–∏–≤—ã—Ö (TL;DR)

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh aurelle@89.39.94.194

# –ü–µ—Ä–µ–π—Ç–∏ –≤ –ø—Ä–æ–µ–∫—Ç
cd ~/projects/aurelle

# –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥ –∏ –¥–µ–ø–ª–æ–π
git fetch origin && \
git reset --hard origin/main && \
chmod +x deploy/scripts/*.sh && \
bash ./deploy/scripts/update.sh
```

–ì–æ—Ç–æ–≤–æ! –ß–µ—Ä–µ–∑ 2-3 –º–∏–Ω—É—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±—É–¥—É—Ç –Ω–∞ —Å–∞–π—Ç–µ.

---

## üìã –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### –®–∞–≥ 1: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É

```bash
ssh aurelle@89.39.94.194
```

**–£—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: `aurelle`
- IP: `89.39.94.194`

### –®–∞–≥ 2: –ü–µ—Ä–µ–π—Ç–∏ –≤ –ø—Ä–æ–µ–∫—Ç

```bash
cd ~/projects/aurelle
```

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ git (–û–î–ò–ù –†–ê–ó!)

–ï—Å–ª–∏ –¥–µ–ª–∞–µ—Ç–µ –ø–µ—Ä–≤—ã–π –¥–µ–ø–ª–æ–π, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∞ —Ñ–∞–π–ª–æ–≤
git config core.filemode false

# –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª—É–∂–µ–±–Ω—ã–µ —Ñ–∞–π–ª—ã
echo "backups/" >> .git/info/exclude
echo "frontend/.env*" >> .git/info/exclude
```

### –®–∞–≥ 4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞

```bash
# –ü–æ–ª—É—á–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git fetch origin

# –ñ—ë—Å—Ç–∫–∏–π —Å–±—Ä–æ—Å –Ω–∞ main (–û–°–¢–û–†–û–ñ–ù–û - –∑–∞—Ç–∏—Ä–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è!)
git reset --hard origin/main

# –î–∞—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
chmod +x deploy/scripts/*.sh
```

### –®–∞–≥ 5: –ó–∞–ø—É—Å–∫ –¥–µ–ø–ª–æ—è

```bash
bash ./deploy/scripts/update.sh
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. ‚úÖ –°–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±—ç–∫–∞–ø –ë–î
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
3. ‚úÖ –°–æ–±–∏—Ä–∞—é—Ç—Å—è –Ω–æ–≤—ã–µ Docker –æ–±—Ä–∞–∑—ã (frontend + backend)
4. ‚úÖ –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è —Å—Ç–∞—Ä—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
5. ‚úÖ –ó–∞–ø—É—Å–∫–∞—é—Ç—Å—è –Ω–æ–≤—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
6. ‚úÖ –í—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
7. ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è health backend

**–í—Ä–µ–º—è:** ~2-3 –º–∏–Ω—É—Ç—ã

### –®–∞–≥ 6: –ü—Ä–æ–≤–µ—Ä–∫–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
docker-compose -f docker-compose.prod.yml ps

# –í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å "Up"
```

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
- https://aurelle.uz - –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- https://api.aurelle.uz/docs - API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- https://api.aurelle.uz/health - health check

---

## üéØ –ß—Ç–æ –±—ã–ª–æ –∏–∑–º–µ–Ω–µ–Ω–æ –≤ —ç—Ç–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏

### Frontend:

1. **–£–±—Ä–∞–Ω localhost –∏–∑ –∫–æ–¥–∞**
   - –§–∞–π–ª: `frontend/src/api/client.ts`
   - –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `https://api.aurelle.uz` –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
   - Fallback –Ω–∞ `window.location.origin`

2. **–°–æ–∑–¥–∞–Ω—ã —Ñ–∞–π–ª—ã –æ–∫—Ä—É–∂–µ–Ω–∏—è**
   - `.env.production` - –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
   - `.env.development` - –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
   - `.env.example` - —à–∞–±–ª–æ–Ω

3. **–û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å–±–æ—Ä–∫–∞**
   - `npm run build` - –±—ã—Å—Ç—Ä–∞—è —Å–±–æ—Ä–∫–∞ (–ë–ï–ó TypeScript –ø—Ä–æ–≤–µ—Ä–∫–∏)
   - `npm run build:prod` - –ø—Ä–æ–¥–∞–∫—à–Ω —Å–±–æ—Ä–∫–∞
   - `npm run build:check` - —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π TypeScript

4. **–û–±–Ω–æ–≤–ª—ë–Ω Dockerfile.prod**
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `https://api.aurelle.uz` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
   - –ü–µ—Ä–µ–¥–∞—ë—Ç—Å—è Yandex Maps API –∫–ª—é—á

### Backend:

- –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π (–µ—Å–ª–∏ –Ω–µ –±—ã–ª–æ –Ω–æ–≤—ã—Ö –∫–æ–º–º–∏—Ç–æ–≤)

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

### –í –±—Ä–∞—É–∑–µ—Ä–µ (F12 ‚Üí Network):

‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
```
https://api.aurelle.uz/api/auth/login
https://api.aurelle.uz/api/salons
https://api.aurelle.uz/api/bookings
```

‚ùå **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ (–Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å):**
```
http://localhost:8000/api/...
```

### –í –∫–æ–Ω—Å–æ–ª–∏:

```bash
# –õ–æ–≥–∏ frontend
docker-compose -f docker-compose.prod.yml logs frontend | tail -50

# –õ–æ–≥–∏ backend
docker-compose -f docker-compose.prod.yml logs backend | tail -50

# –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose -f docker-compose.prod.yml ps
```

---

## üêõ –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫

### Frontend –Ω–µ —Å–æ–±—Ä–∞–ª—Å—è

**–û—à–∏–±–∫–∞:**
```
ERROR: failed to solve: process "/bin/sh -c npm run build:prod"
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å —Å —á–∏—Å—Ç–æ–≥–æ –ª–∏—Å—Ç–∞
docker-compose -f docker-compose.prod.yml build --no-cache frontend
docker-compose -f docker-compose.prod.yml up -d frontend
```

### Backend –Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker-compose -f docker-compose.prod.yml logs backend

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
docker-compose -f docker-compose.prod.yml restart backend
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º–∞

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –±—ç–∫–∞–ø—ã
ls -lht ./backups/*.sql.gz | head -5

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ
bash ./deploy/scripts/restore.sh ./backups/backup_YYYYMMDD_HHMMSS.sql.gz
```

### –û—Ç–∫–∞—Ç –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é –≤–µ—Ä—Å–∏—é

```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–æ–º–º–∏—Ç—ã
git log --oneline | head -10

# –û—Ç–∫–∞—Ç–∏—Ç—å—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∫–æ–º–º–∏—Ç
git reset --hard <commit_hash>

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å
docker-compose -f docker-compose.prod.yml up -d --build
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤:

```bash
# –ü–∞–º—è—Ç—å –∏ CPU –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker stats

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞
df -h

# –†–∞–∑–º–µ—Ä –±—ç–∫–∞–ø–æ–≤
du -sh ./backups
```

### –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:

```bash
# –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose -f docker-compose.prod.yml logs -f

# –¢–æ–ª—å–∫–æ frontend
docker-compose -f docker-compose.prod.yml logs -f frontend

# –¢–æ–ª—å–∫–æ backend
docker-compose -f docker-compose.prod.yml logs -f backend
```

---

## üîÑ –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –∑–∞–¥–∞—á–∏

### –ï–∂–µ–¥–Ω–µ–≤–Ω–æ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏):
- ‚úÖ –ë—ç–∫–∞–ø –ë–î –≤ 3:00 (–Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –≤ crontab)

### –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ (–≤—Ä—É—á–Ω—É—é):
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±—ç–∫–∞–ø—ã
ls -lh ./backups/daily/ | tail -7

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker-compose -f docker-compose.prod.yml logs backend | grep ERROR

# –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ Docker –æ–±—Ä–∞–∑—ã
docker system prune -a -f
```

### –ü–µ—Ä–µ–¥ –≤–∞–∂–Ω—ã–º–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏:
```bash
# –°–æ–∑–¥–∞—Ç—å —Ä—É—á–Ω–æ–π –±—ç–∫–∞–ø
bash ./deploy/scripts/backup.sh

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –±—ç–∫–∞–ø —Å–æ–∑–¥–∞–ª—Å—è
ls -lh ./backups/backup_*.sql.gz | tail -1
```

---

## üìù –ß–µ–∫-–ª–∏—Å—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

**–ü–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º:**
- [ ] –ö–æ–¥ –∑–∞–∫–æ–º–º–∏—á–µ–Ω –∏ –∑–∞–ø—É—à–µ–Ω –≤ GitHub
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω –Ω–∞ localhost/dev –æ–∫—Ä—É–∂–µ–Ω–∏–∏
- [ ] –í .env –µ—Å—Ç—å –≤—Å–µ –Ω—É–∂–Ω—ã–µ –∫–ª—é—á–∏ (Yandex Maps, –ø–ª–∞—Ç–µ–∂–∏)

**–í–æ –≤—Ä–µ–º—è –¥–µ–ø–ª–æ—è:**
- [ ] –ü–æ–¥–∫–ª—é—á–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É
- [ ] –ü–µ—Ä–µ—à—ë–ª –≤ ~/projects/aurelle
- [ ] –í—ã–ø–æ–ª–Ω–∏–ª git fetch && git reset --hard origin/main
- [ ] –ó–∞–ø—É—Å—Ç–∏–ª bash ./deploy/scripts/update.sh
- [ ] –î–æ–∂–¥–∞–ª—Å—è "UPDATE COMPLETED SUCCESSFULLY!"

**–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:**
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª https://aurelle.uz –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª –ª–æ–≥–∏: docker-compose -f docker-compose.prod.yml logs
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª —Å—Ç–∞—Ç—É—Å: docker-compose -f docker-compose.prod.yml ps
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é/–ª–æ–≥–∏–Ω
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª —á—Ç–æ –∫–∞—Ä—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç

---

## üéâ –ì–æ—Ç–æ–≤–æ!

–û–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–¥–µ–ø–ª–æ–µ–Ω—ã –Ω–∞ **https://aurelle.uz**

**–ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏:**
- [–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞](FRONTEND_DEPLOYMENT.md)
- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –±—ç–∫–∞–ø–∞–º](BACKUP_GUIDE.md)
- [–ë—ã—Å—Ç—Ä–∞—è —à–ø–∞—Ä–≥–∞–ª–∫–∞](QUICK_REFERENCE.md)
- [–î–µ–ø–ª–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è](DEPLOYMENT_GUIDE.md)

**–ö–æ–Ω—Ç–∞–∫—Ç—ã:**
- –°–µ—Ä–≤–µ—Ä: `aurelle@89.39.94.194`
- –°–∞–π—Ç: https://aurelle.uz
- API: https://api.aurelle.uz

---

üí° **–°–æ–≤–µ—Ç:** –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —ç—Ç—É –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –≤ –∑–∞–∫–ª–∞–¥–∫–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞!
